<include file="Public/header"/>
<div class="store-wrap">
    <div class="crumbs">
        <a href="">首页&gt;</a>
        <a href="">我的商城&gt;</a>
        <a href="" class="active">地址管理</a>
    </div>
    <div class="main clearfix">
    <include file="Public/nav"/>
        <div class="right-content f-fr">
            <div class="address-main">
                <div class="main">
                    <div class="row">
                        <span class="title rollit">新增收货地址</span>
                        <span class="gray">（您目前已有地址<i class="already">{$count}</i>个，最多还可以增加<i class="settle">{$last}</i>个）</span>
                    </div>
                    <form id="valid-form" method="post" action="{:U('Home/Address/add')}">
                        <!-- 修改地址时要用的地址id -->
                        <input class="addressId" type="hidden" value="">

                        <div class="content">
                            <div class="row namePhone clearfix">
                                <div class="f-fl addressName">
                                    <span>收货人姓名<i class="mark">*</i></span>
                                    <input id="name" class="varify" name="name" type="text" placeholder="长度不超过12个字" maxlength="12">
                                </div>
                                <div class="f-fl addressPhone">
                                    <span>收货人手机号<i class="mark">*</i></span>
                                    <input id="phone" name="tel" class="varify" type="text" placeholder="请输入11位手机号" maxlength="11">
                                </div>
                            </div>
                            <div class="row clearfix receverAddress">
                                <span class="f-fl">收货人地址<i class="mark">*</i></span>
                                <div class="info">
										<select id="s_province" name="s_province" style="border:solid lightgray 1px;width:150px;height:30px"></select>
										<select id="s_city" name="s_city" style="border:solid lightgray 1px;width:150px;height:30px"></select> 
										<select id="s_county" name="s_county" style="border:solid lightgray 1px;width:150px;height:30px"></select>
										<script class="resources library" src="__PUBLIC__/Home/js/area.js" type="text/javascript"></script>
										<script type="text/javascript">_init_area();</script>
									<div id="show"></div>
								</div>
								
                            </div>
                            <div class="row  detailAddress">
                                <span>详细地址<i class="mark">*&nbsp;&nbsp;&nbsp;</i></span>
                                <input id="detailAddress" name="address" class="varify" type="text" placeholder="请输入不超过50个字的详细地址，例如：路名，门牌号" maxlength="50">
                            </div>
							邮政编码<font color="red">*</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" id="postalcode" name="postalcode" placeholder="请输入不超过6个字的邮政编码" maxlength="6" style="height:30px;width:200px"/>
                            <div class="opreat">
                                <label for="default">
								<input type="hidden" value="{$mk}" id="ma"/>
                                    <input id="default" class="setDefault" type="checkbox" name="mask" value="1">设为默认
                                </label>
                                <input type="submit" class="saveAddress" id="sub"/>
                            </div>
                        </div>
                    </form>
					
                    <div class="list">
                        <div class="row">
                            <div class="title">
                                <div>已有地址</div>
                                <div class="upload hide">
                                    <i class="iconfont icon-zhuyi"></i>
                                    <span>因配送地址库数据升级，请点击地址进行升级，让您享受更好的配送服务！</span>
                                </div>
                            </div>
                        </div>
                        <div class="listHead">
                            <span class="center w15">收货人姓名</span><span class="center w35">收货人地址</span><span class="center w25">收货人手机号</span><span class="center w10">详情</span><span class="center w10">操作</span>
                        </div>
						
                        <ul id="tableList" class="">
						<notempty name="address">
						<foreach name="address" item="val">
							<li>
								<input class="addressId" type="hidden" value="5351279493000">
								<input class="isOld" type="hidden" value="0">
								<span class="center w15">{$val.name}</span>
								<span class="completeAddress center w35">{$val.address}</span>
								<span class="center w25">{$val.tel}</span>
								<span class="center w25 mask1">{$val.mask}</span>
								<span class="center w10">
								  <a class="del" href="javascript:;" onclick="del({$val['id']},this)">删除</a>
								</span>
								<span class="left w15">
									<a class="beDefault" id="mask" href="javascript:;" onclick="mask({$val['id']},this)">设为默认</a>
								</span>
							</li>
						</foreach>
						<else/>
							<li>
								<span>您还没有收货地址，添加吧</span>
							</li>
						</notempty>
						</ul>
						
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="__PUBLIC__/Home/js/layout-208548c914.js" type="text/javascript"></script>
<script type="text/javascript" src="__PUBLIC__/Home/js/memberCommon.js"></script>
<script type="text/javascript" src="__PUBLIC__/Home/js/address.js"></script>
<script>
	
    var __mzt = __mzt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "__PUBLIC__/Home/js/analytics-min.js";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
<script type="text/javascript">
var Gid  = document.getElementById ;
var showArea = function(){
	Gid('show').innerHTML = "<h3>省" + Gid('s_province').value + " - 市" + 	
	Gid('s_city').value + " - 县/区" + 
	Gid('s_county').value + "</h3>"
							}
Gid('s_county').setAttribute('onchange','showArea()');

</script>
<script type="text/javascript">
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "__PUBLIC__/Home/js/hm.js?2a0c04774115b182994cfcacf4c122e9";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
<script type="text/javascript">
	if($('#ma').val()==1){
		$('#default').attr('checked',true);
	}
	function del(id,obj){
		$.get("{:U('Home/Address/del')}",{'id':id},function(result){
				alert(result);
				
			},'json');
			$(obj).parent().parent().remove();
	}
	function mask(id,obj){
		$.get("{:U('Home/Address/mask')}",{'id':id},function(result){
			//alert(result);
			},'json');
			//alert($(obj).html());
		//console.dir($(".mask1").get());
			$(".mask1").each(function(i){
				$(this).html('备份地址');
			});
			//$('#mask1').html('备份地址');
			$(obj).parent().prev().prev().html('默认地址');
		}
	$('#sub').click(function(){
		if($('#name').val()==""){
			alert('请输入收货人姓名');
			return false;
		}
		if($('#s_province').val()=="省份"){
			alert('请选择省份');
			return false;
		}
		if($('#s_city').val()=="市"){
			alert('请选择市');
			return false;
		}
		if($('#s_county').val()=="区"){
			alert('请选择区');
			return false;
		}
		var exp=/^1[34578]\d{9}$/;
		if(!exp.test($('#phone').val())){
			alert('请输入正确的手机号');
			return false;
		}
		var exp1=/^[1-9]\d{5}$/;
		if(!exp1.test($('#postalcode').val())){
			alert('请输入正确的邮政编码');
			return false;
		}
	})
</script>
<include file="Public/footer"/>